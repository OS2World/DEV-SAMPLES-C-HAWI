@ECHO OFF

IF "%1"=="" GOTO NODBNAME

REM *** An Datenbank anbinden
DB2 CONNECT TO %1

ECHO "Produkt","Verk„ufe" > AUS1.CSV
DB2 EXPORT TO AUS.CSV OF DEL MODIFIED BY coldel; SELECT B.BEZEICHNUNG AS "Produkt", SUM(C.ANZAHL) AS "Verk„ufe" FROM PRODUKT B, VERKAUF C WHERE B.SCHLUESSEL=C.PRODUKT GROUP BY B.BEZEICHNUNG
COPY AUS1.CSV+AUS.CSV
ECHO "Kunde","Produkt","Verk„ufe" > AUS2.CSV
DB2 EXPORT TO AUS.CSV OF DEL MODIFIED BY coldel; SELECT A.BEZEICHNUNG AS "Kunde",B.BEZEICHNUNG AS "Produkt",SUM(C.ANZAHL) AS "Verk„ufe" FROM KUNDE A,PRODUKT B,VERKAUF C WHERE A.SCHLUESSEL=C.KUNDE AND B.SCHLUESSEL=C.PRODUKT GROUP BY A.BEZEICHNUNG,B.BEZEICHNUNG
COPY AUS2.CSV+AUS.CSV
DEL AUS.CSV
DEL AUS1.MSG
DEL AUS2.MSG

DB2 CONNECT RESET
GOTO EXIT

:NODBNAME
echo AUSEXP.CMD - Datenbankname fehlt.
GOTO EXIT

:EXIT

